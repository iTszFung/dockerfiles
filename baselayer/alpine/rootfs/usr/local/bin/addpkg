#!/usr/bin/env bash
# addpkg v0.1.0 安装软件包工具

. /usr/lib/functions

info() {
  apk info && apk stats
}

update() {
  apk --no-cache update
}

add() {
  apk add --no-cache $@
}

virtual() {
	local DEPS=".build-deps"
	[ $1 ~= *deps ] && DEPS=$1
  shift
  apk add --no-cache --virtual $DEPS $@
}

url() {
  local url=$1
  local tmpf=${url##*/}
  wget -q $url -O $tmpf
  apk add --allow-untrusted $tmpf && \
  rm -rf $tmpf
}

case "$1" in
  url|virtual|update|info)
    eval "$@" && exit 0
  ;;
  *)
   add $@
  ;;
esac
